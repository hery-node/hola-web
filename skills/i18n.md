# Hola Web Localization Skill

## Overview

The `hola-web` library provides built-in internationalization (i18n) support using `vue-i18n`. The library includes pre-defined locale messages for common UI elements like forms, tables, confirmations, and validation messages.

## Built-in Locale Files

The library ships with locale files in `src/locales/`:

- `en.json` - English (default)
- `zh.json` - Chinese (中文)

These files contain translations for:

| Category    | Description                                   |
| ----------- | --------------------------------------------- |
| `type.*`    | Type validation messages and labels           |
| `form.*`    | Form titles, buttons, and success/error hints |
| `confirm.*` | Confirmation dialog buttons                   |
| `table.*`   | Table headers, actions, and messages          |
| `compare.*` | Comparison view labels                        |
| `log.*`     | Log viewer labels                             |

## Using Locale Messages in Third-Party Applications

### Option 1: Import Locale JSON Directly

```typescript
import holaEnMessages from "hola-web/locales/en.json";
import holaZhMessages from "hola-web/locales/zh.json";

// Merge with your app's messages
const messages = {
  en: {
    ...holaEnMessages,
    // Your app-specific messages
    myApp: {
      title: "My Application",
      welcome: "Welcome!",
    },
  },
  zh: {
    ...holaZhMessages,
    myApp: {
      title: "我的应用",
      welcome: "欢迎！",
    },
  },
};

initApp(app, {
  localeMessages: messages,
  locale: "en",
});
```

### Option 2: Use loadLocaleMessagesEager with deepMerge (Recommended)

```typescript
import { loadLocaleMessagesEager, deepMerge, initApp } from "hola-web";
import holaEnMessages from "hola-web/locales/en.json";
import holaZhMessages from "hola-web/locales/zh.json";

// Load your own locales using Vite's glob import
const appLocales = import.meta.glob("./locales/*.json", { eager: true }) as Record<string, { default: Record<string, unknown> }>;
const appMessages = loadLocaleMessagesEager(appLocales);

// Deep merge hola-web messages with your app messages
// This preserves nested keys (e.g., type.boolean_true) while allowing overrides
const mergedMessages = {
  en: deepMerge(holaEnMessages as Record<string, unknown>, (appMessages.en || {}) as Record<string, unknown>),
  zh: deepMerge(holaZhMessages as Record<string, unknown>, (appMessages.zh || {}) as Record<string, unknown>),
};

initApp(app, {
  localeMessages: mergedMessages,
  locale: "en",
});
```

> **Important:** Use `deepMerge` instead of spread operator (`...`) when your app has its own `type`, `form`, `table`, or other nested message objects. Spread operator does shallow merge which completely replaces nested objects, causing missing translations like `type.boolean_true`.

### Option 3: Override hola-web Default Messages

If you want to customize or override specific hola-web messages, simply define the same keys in your locale file. Your messages will take precedence when merged using `deepMerge`:

```typescript
import { loadLocaleMessagesEager, deepMerge, initApp } from "hola-web";
import holaEnMessages from "hola-web/locales/en.json";
import holaZhMessages from "hola-web/locales/zh.json";

// Your app's locale file (e.g., ./locales/en.json)
// {
//   "form": {
//     "submit_label": "Save",           // Override: "Submit" -> "Save"
//     "cancel_label": "Go Back"         // Override: "Cancel" -> "Go Back"
//   },
//   "table": {
//     "no_data": "Nothing to display"   // Override: "No data available" -> "Nothing to display"
//   }
// }

const appLocales = import.meta.glob("./locales/*.json", { eager: true }) as Record<string, { default: Record<string, unknown> }>;
const appMessages = loadLocaleMessagesEager(appLocales);

// App messages come LAST to override hola-web defaults (use deepMerge to preserve nested keys)
const mergedMessages = {
  en: deepMerge(holaEnMessages as Record<string, unknown>, (appMessages.en || {}) as Record<string, unknown>),
  zh: deepMerge(holaZhMessages as Record<string, unknown>, (appMessages.zh || {}) as Record<string, unknown>),
};

initApp(app, {
  localeMessages: mergedMessages,
  locale: "en",
});
```

**Example override locale file (`./locales/en.json`):**

```json
{
  "form": {
    "submit_label": "Save",
    "cancel_label": "Go Back",
    "create_title": "New {entity}",
    "update_title": "Edit {entity}"
  },
  "table": {
    "no_data": "Nothing to display",
    "delete_confirm": "Delete this {entity}? This action cannot be undone."
  },
  "confirm": {
    "yes": "Confirm",
    "no": "Cancel"
  }
}
```

This approach allows you to:

- Keep hola-web's defaults for most messages
- Override only the specific messages you want to customize
- Maintain full control over the user-facing text in your application

## Accessing Translations in Components

### Using Template Syntax

```vue
<template>
  <v-btn>{{ $t("form.submit_label") }}</v-btn>
  <span>{{ $t("form.create_title", { entity: "User" }) }}</span>
</template>
```

### Using Composition API

```typescript
import { useI18n } from "vue-i18n";

const { t, locale } = useI18n();

// Get translation
const submitLabel = t("form.submit_label");

// With interpolation
const title = t("form.create_title", { entity: "User" });

// Switch locale
locale.value = "zh";
```

## Message Key Reference

### Type Messages (`type.*`)

| Key                  | English                                | Chinese                            |
| -------------------- | -------------------------------------- | ---------------------------------- |
| `type.boolean`       | {field} must be a valid boolean value. | {field} 必须是有效的布尔值。       |
| `type.int`           | {field} must be a valid integer.       | {field} 必须是有效的整数。         |
| `type.email`         | {field} must be a valid email address. | {field} 必须是有效的电子邮件地址。 |
| `type.url`           | {field} must be a valid URL.           | {field} 必须是有效的网址。         |
| `type.boolean_true`  | Yes                                    | 是                                 |
| `type.boolean_false` | No                                     | 否                                 |
| `type.gender_male`   | Male                                   | 男                                 |
| `type.gender_female` | Female                                 | 女                                 |

### Form Messages (`form.*`)

| Key                        | English                        | Chinese            |
| -------------------------- | ------------------------------ | ------------------ |
| `form.create_title`        | Create {entity}                | 创建{entity}       |
| `form.update_title`        | Update {entity}                | 更新{entity}       |
| `form.cancel_label`        | Cancel                         | 取消               |
| `form.submit_label`        | Submit                         | 提交               |
| `form.required`            | {field} is required.           | {field} 是必填项。 |
| `form.create_success_hint` | {entity} created successfully. | {entity}创建成功。 |
| `form.err_duplicate`       | This {entity} already exists.  | 该{entity}已存在。 |

### Table Messages (`table.*`)

| Key                    | English                                        | Chinese                    |
| ---------------------- | ---------------------------------------------- | -------------------------- |
| `table.title`          | {entity} List                                  | {entity}列表               |
| `table.action_header`  | Actions                                        | 操作                       |
| `table.no_data`        | No data available                              | 暂无数据                   |
| `table.delete_confirm` | Are you sure you want to delete this {entity}? | 确定要删除这个{entity}吗？ |
| `table.total_record`   | ({total} records)                              | （共 {total} 条记录）      |

### Confirmation Messages (`confirm.*`)

| Key             | English | Chinese |
| --------------- | ------- | ------- |
| `confirm.yes`   | Yes     | 是      |
| `confirm.no`    | No      | 否      |
| `confirm.close` | Close   | 关闭    |

## Adding New Locales

To add support for a new language:

1. Create a new JSON file in `src/locales/` (e.g., `fr.json` for French)
2. Copy the structure from `en.json` and translate all values
3. The file will be automatically picked up by the glob import

```json
// src/locales/fr.json
{
  "type": {
    "boolean": "{field} doit être une valeur booléenne valide.",
    "int": "{field} doit être un entier valide.",
    ...
  },
  "form": {
    "create_title": "Créer {entity}",
    "cancel_label": "Annuler",
    "submit_label": "Soumettre",
    ...
  }
}
```

## Entity-Specific Labels

For entity-specific field labels and hints, add them under the entity name:

```json
{
  "user": {
    "_label": "User",
    "name": "Username",
    "name_hint": "Enter your username",
    "email": "Email Address",
    "email_hint": "Enter a valid email"
  },
  "product": {
    "_label": "Product",
    "name": "Product Name",
    "name_hint": "Enter the product name",
    "price": "Price",
    "price_hint": "Enter the price in USD"
  }
}
```

The `_label` key is used for the entity display name in form titles and confirmation messages.

## Runtime Locale Switching

```typescript
import { useI18n } from "vue-i18n";

const { locale } = useI18n();

function switchLanguage(lang: string) {
  locale.value = lang;
  // Optionally persist to localStorage
  localStorage.setItem("locale", lang);
}
```

## Best Practices

1. **Always use interpolation** for dynamic content: `$t('form.create_title', { entity: entityName })`
2. **Keep translations consistent** across all locale files
3. **Use the `_hint` suffix** for field hints/placeholders
4. **Use the `_label` key** for entity display names
5. **Avoid hardcoding strings** in components - always use `$t()`
6. **Use human-readable labels** - Field labels should be proper English words, not code-style names. For example:
   - `is_active` → `"Active"` ✅ (not `"Is_active"` ❌)
   - `created_at` → `"Created At"` or `"Created"` ✅ (not `"Created_at"` ❌)
   - `user_name` → `"Username"` or `"User Name"` ✅ (not `"User_name"` ❌)
